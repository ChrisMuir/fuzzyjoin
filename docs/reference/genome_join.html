<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Join two tables based on overlapping genomic intervals: both a — genome_join • fuzzyjoin</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">fuzzyjoin</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/stringdist_join.html">Example of `stringdist_inner_join`: Correcting misspellings against a dictionary</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Join two tables based on overlapping genomic intervals: both a</h1>
    </div>

    
    <p>This is an extension of <code><a href='interval_join.html'>interval_join</a></code> specific to genomic intervals.
Genomic intervals include both a chromosome ID and an interval: items are only
considered matching if the chromosome ID matches and the interval overlaps.
Note that there must be three arguments to by, and that they must be in the order
c("chromosome", "start", "end").</p>
    

    <pre class="usage"><span class='fu'>genome_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"inner"</span>, <span class='no'>...</span>)

<span class='fu'>genome_inner_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>genome_left_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>genome_right_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>genome_full_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>genome_semi_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>genome_anti_join</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A tbl</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A tbl</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>Names of columns to join on, in order c("chromosome", "start", "end").
A match will be counted only if the chromosomes are equal and the start/end pairs
overlap.</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>One of "inner", "left", "right", "full" "semi", or "anti"</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra arguments passed on to <code><a href='http://www.rdocumentation.org/packages/IRanges/topics/findOverlaps-methods'>findOverlaps</a></code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All the extra arguments to <code><a href='interval_join.html'>interval_join</a></code>, which are
passed on to <code><a href='http://www.rdocumentation.org/packages/IRanges/topics/findOverlaps-methods'>findOverlaps</a></code>, work for <code>genome_join</code>
as well. These include <code>maxgap</code> and <code>minoverlap</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>library</span>(<span class='no'>dplyr</span>)

<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/reexports.html'>data_frame</a></span>(<span class='kw'>id1</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>4</span>,
                 <span class='kw'>chromosome</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chr1"</span>, <span class='st'>"chr1"</span>, <span class='st'>"chr2"</span>, <span class='st'>"chr2"</span>),
                 <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>300</span>, <span class='fl'>400</span>),
                 <span class='kw'>end</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>150</span>, <span class='fl'>250</span>, <span class='fl'>350</span>, <span class='fl'>450</span>))

<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/reexports.html'>data_frame</a></span>(<span class='kw'>id2</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>4</span>,
                 <span class='kw'>chromosome</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chr1"</span>, <span class='st'>"chr2"</span>, <span class='st'>"chr2"</span>, <span class='st'>"chr1"</span>),
                 <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>140</span>, <span class='fl'>210</span>, <span class='fl'>400</span>, <span class='fl'>300</span>),
                 <span class='kw'>end</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>160</span>, <span class='fl'>240</span>, <span class='fl'>415</span>, <span class='fl'>320</span>))

<span class='co'># note that the the third and fourth items don't join (even though</span>
<span class='co'># 300-350 and 300-320 overlap) since the chromosomes are different:</span>
<span class='fu'>genome_inner_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 2 x 8
#&gt;     id1 chromosome.x start.x end.x   id2 chromosome.y start.y end.y
#&gt;   &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1         chr1     100   150     1         chr1     140   160
#&gt; 2     4         chr2     400   450     3         chr2     400   415</div><div class='input'>
<span class='co'># other functions:</span>
<span class='fu'>genome_full_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 8
#&gt;     id1 chromosome.x start.x end.x   id2 chromosome.y start.y end.y
#&gt;   &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1         chr1     100   150     1         chr1     140   160
#&gt; 2     4         chr2     400   450     3         chr2     400   415
#&gt; 3     2         chr1     200   250    NA         &lt;NA&gt;      NA    NA
#&gt; 4     3         chr2     300   350    NA         &lt;NA&gt;      NA    NA
#&gt; 5    NA         &lt;NA&gt;      NA    NA     2         chr2     210   240
#&gt; 6    NA         &lt;NA&gt;      NA    NA     4         chr1     300   320</div><div class='input'><span class='fu'>genome_left_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 4 x 8
#&gt;     id1 chromosome.x start.x end.x   id2 chromosome.y start.y end.y
#&gt;   &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1         chr1     100   150     1         chr1     140   160
#&gt; 2     2         chr1     200   250    NA         &lt;NA&gt;      NA    NA
#&gt; 3     3         chr2     300   350    NA         &lt;NA&gt;      NA    NA
#&gt; 4     4         chr2     400   450     3         chr2     400   415</div><div class='input'><span class='fu'>genome_right_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 4 x 8
#&gt;     id1 chromosome.x start.x end.x   id2 chromosome.y start.y end.y
#&gt;   &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;        &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1         chr1     100   150     1         chr1     140   160
#&gt; 2    NA         &lt;NA&gt;      NA    NA     2         chr2     210   240
#&gt; 3     4         chr2     400   450     3         chr2     400   415
#&gt; 4    NA         &lt;NA&gt;      NA    NA     4         chr1     300   320</div><div class='input'><span class='fu'>genome_semi_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 2 x 4
#&gt;     id1 chromosome start   end
#&gt;   &lt;int&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     1       chr1   100   150
#&gt; 2     4       chr2   400   450</div><div class='input'><span class='fu'>genome_anti_join</span>(<span class='no'>x1</span>, <span class='no'>x2</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>))</div><div class='output co'>#&gt; # A tibble: 2 x 4
#&gt;     id1 chromosome start   end
#&gt;   &lt;int&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     2       chr1   200   250
#&gt; 2     3       chr2   300   350</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by David Robinson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
